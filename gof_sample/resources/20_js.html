<html><head><title>java sample code</title><meta http-equiv="Content-Type" content="text/html; charset=x-sjis"></head><body bgcolor=#ffffff text=#000000><img src="img/00/java.gif" hspace="10"><font style="margin-left:40px"><p><pre>/* *  TCPOctetStream */public class TCPOctetStream {    // ...}/* *  TCPConnection * *  役割：&lt;Context&gt; */public class TCPConnection {    public TCPConnection() {        _state = TCPClosed.instance();    }    public void activeOpen() {        _state.activeOpen(this);    }    public void passiveOpen() {        _state.passiveOpen(this);    }    public void close() {        _state.close(this);    }    public void send() {        _state.send(this);    }    public void acknowledge() {        _state.acknowledge(this);    }    public void synchronize() {        _state.synchronize(this);    }    public void processOctet(TCPOctetStream o) {        // ...    }    public void changeState(TCPState s) {        _state = s;    }    TCPState _state;}/* *  TCPState * *  役割：&lt;State&gt; */public class TCPState {    public void transmit(TCPConnection t, TCPOctetStream o) { }    public void activeOpen(TCPConnection t) { }    public void passiveOpen(TCPConnection t) { }    public void close(TCPConnection t) { }    public void synchronize(TCPConnection t) { }    public void acknowledge(TCPConnection t) { }    public void send(TCPConnection t) { }    protected void changeState(TCPConnection t, TCPState s) {        t.changeState(s);    }}/* *  TCPEstablished * *  役割：&lt;ConcreteState&gt; */public class TCPEstablished extends TCPState {    public static TCPState instance() {        // ...    }    public void transmit(TCPConnection t, TCPOctetStream o) {        t.processOctet(o);    }    public void close(TCPConnection t) {        // FIN 送信、それに対する ACK 受信        changeState(t, TCPListen.instance());    }}/* *  TCPListen * *  役割：&lt;ConcreteState&gt; */public class TCPListen extends TCPState {    public static TCPState instance() {        // ...    }    public void send(TCPConnection t) {        // SYN 送信、SYN と ACK 受信、ACK 送信、など        changeState(t, TCPEstablished.instance());    }    // ...}/* *  TCPClosed * *  役割：&lt;ConcreteState&gt; */public class TCPClosed extends TCPState {    public static TCPState instance() {        // ...    }    public void activeOpen(TCPConnection t) {        // SYN 送信、SYN と ACK 受信、ACK 送信、など        changeState(t, TCPEstablished.instance());    }    public void passiveOpen(TCPConnection t) {        changeState(t, TCPListen.instance());    }    // ...}</pre><p></font></body></html>