<html><head><title>java sample code</title><meta http-equiv="Content-Type" content="text/html; charset=x-sjis"></head><body bgcolor=#ffffff text=#000000><img src="img/00/java.gif" hspace="10"><font style="margin-left:40px"><p><pre>import java.io.*;/* *  Scanner * *  役割：&lt;subsystem class&gt;/Facade */public class Scanner {    public Scanner(InputStream in) {        _inputStream = in;        // ...    }    protected void finalize() throws IOException {        // ...        _inputStream.close(); // InputStream を閉じる    }    public Token scan() {        // ...    }    private InputStream _inputStream;}/* *  Parser * *  役割：&lt;subsystem class&gt;/Facade */public class Parser {    public Parser() {        // ...    }    public void parse(Scanner scanner, ProgramNodeBuilder builder) {        // ...    }}/* *  ProgramNodeBuilder * *  役割：&lt;subsystem class&gt;/Facade, &lt;ConcreteBuilder&gt;/Builder */public class ProgramNodeBuilder {    ProgramNodeBuilder() {        // ...    }    public ProgramNode newVariable(String variableName) {        // ...    }    public ProgramNode newAssignment(ProgramNode variable,                                     ProgramNode expression) {        // ...    }    public ProgramNode newReturnStatement(ProgramNode value) {        // ...    }    public ProgramNode newCondition(ProgramNode condition,                                    ProgramNode truePart,                                    ProgramNode falsePart  ) {        // ...    }    // ...    public ProgramNode getRootNode() {        // ...    }    private ProgramNode _node;}/* *  ProgramNode * *  役割：&lt;subsystem class&gt;/Facade, &lt;Component&gt;/Composite */public abstract class ProgramNode {    // プログラムノードの操作    public abstract int getSourcePositionLine();    public abstract int getSourcePositionIndex();    // ...    // 子の操作    public abstract void add(ProgramNode p);    public abstract void remove(ProgramNode p);    public abstract java.util.Enumeration createEnumeration();    // ...    public abstract void traverse(CodeGenerator cg);}/* *  CodeGenerator * *  役割：&lt;subsystem class&gt;/Facade, &lt;Visitor&gt;/Visitor */public abstract class CodeGenerator {    public CodeGenerator(BytecodeStream bs) {        // ...    }    public void visit(StatementNode n) {        // ...    }    public void visit(ExpressionNode n) {        // ...    }    // ...    protected BytecodeStream _output;}/* *  StackMachineCodeGenerator * *  役割：&lt;subsystem class&gt;/Facade, &lt;ConcreteVisitor&gt;/Visitor */public class StackMachineCodeGenerator extends CodeGenerator {    // ...}/* *  RISCCodeGenerator * *  役割：&lt;subsystem class&gt;/Facade, &lt;ConcreteVisitor&gt;/Visitor */public class RISCCodeGenerator extends CodeGenerator {    // ...}import java.util.Enumeration;/* *  ExpressionNode * *  役割：&lt;subsystem class&gt;/Facade, &lt;Composite&gt;/Composite */public class ExpressionNode extends ProgramNode {    // ...    public void traverse(CodeGenerator cg) {        cg.visit(this);        Enumeration i = this.createEnumeration();        while (i.hasMoreElements()) {            ((ProgramNode)i.nextElement()).traverse(cg);        }    }    public Enumeration createEnumeration() {        // ...    }    // ...}/* *  CompilerAsFacade * *  役割：&lt;Facade&gt;/Facade * *  C++ 版サンプルコードでは Compiler クラスであるが、Java ではこの名の *  クラスが既に定義されているので、混同を避けるために CompilerAsFacade *  とした。 */public class CompilerAsFacade {    public CompilerAsFacade() {        // ...    }    public void compile(InputStream input, BytecodeStream output) {        Scanner scanner = new Scanner(input);        ProgramNodeBuilder builder = new ProgramNodeBuilder();        Parser parser = new Parser();        parser.parse(scanner, builder);        RISCCodeGenerator generator = RISCCodeGenerator(output);        ProgramNode parseTree = builder.getRootNode();        parseTree.traverse(generator);    }}</pre><p></font></body></html>