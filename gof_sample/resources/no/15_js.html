<html><head><title>java sample code</title><meta http-equiv="Content-Type" content="text/html; charset=x-sjis"></head><body bgcolor=#ffffff text=#000000><img src="img/00/java.gif" hspace="10"><font style="margin-left:40px"><p>使用例：<p><pre>      BooleanExp expression;      Context context;      VariableExp x = new VariableExp("X");      VariableExp y = new VariableExp("Y");      expression = new OrExp(          new AndExp(new Constant(true), x),          new AndExp(y, new NotExp(x))      );      context.assign(x, false);      context.assign(y, true);      boolean result1 = expression.evaluate(context);      VariableExp z = new VariableExp("Z");      NotExp not_z(z);      BooleanExp = replacement = expression.replace("Y", not_z);      context.assign(z, true);      boolean result2 = replacement.evaluate(context);</pre><hr><pre>/* *  BooleanExp * *  役割：&lt;AbstractExpression&gt; */public abstract class BooleanExp implements Cloneable {    public BooleanExp() {}    public abstract boolean evaluate(Context aContext);    public abstract BooleanExp replace(String name, BooleanExp exp);    public Object clone() {        Object obj = null;        try {            obj = super.clone();        } catch (CloneNotSupportedException e) { }        return obj;    }}/* *  Context * *  役割：&lt;Context&gt; */public class Context {    public boolean lookup(String name) {        return ((Boolean)table.get(name)).booleanValue();            // name で参照される変数が存在しない場合、            // NullPointerException を投げる    }    public void assign(VariableExp exp, boolean b) {        if (b) {            table.put(exp.getName(), Boolean.TRUE);        } else {            table.put(exp.getName(), Boolean.FALSE);        }    }    private java.util.Hashtable table = new java.util.Hashtable();}/* *  VariableExp * *  役割：&lt;TerminalExpression&gt; */public class VariableExp extends BooleanExp {    public VariableExp(String name) {        _name = name;    }    public boolean evaluate(Context aContext) {        return aContext.lookup(_name);    }    public BooleanExp replace(String name, BooleanExp exp) {        if (name.equals(_name)) {            return (BooleanExp)exp.clone();        } else {            return (BooleanExp)this.clone();        }    }    public Object clone() {        return new VariableExp(_name);    }    public String getName() { return _name; }    private String _name;}/* *  Constant * *  役割：&lt;TerminalExpression&gt; */public class Constant extends BooleanExp {    public Constant(boolean value) {        _value = value;    }    public boolean evaluate(Context aContext) {        return _value;    }    public BooleanExp replace(String name, BooleanExp exp) {        return (BooleanExp)this.clone();    }    public Object clone() {        return new Constant(_value);    }    private boolean _value;}/* *  AndExp * *  役割：&lt;NonterminalExpression&gt; */public class AndExp extends BooleanExp {    public AndExp(BooleanExp op1, BooleanExp op2) {        _operand1 = op1;        _operand2 = op2;    }    public boolean evaluate(Context aContext) {        return _operand1.evaluate(aContext) &&                                      _operand2.evaluate(aContext);    }    public BooleanExp replace(String name, BooleanExp exp) {        return new AndExp(_operand1.replace(name, exp),                          _operand2.replace(name, exp));    }    public Object clone() {        return new AndExp((BooleanExp)_operand1.clone(),                          (BooleanExp)_operand2.clone());    }    private BooleanExp _operand1;    private BooleanExp _operand2;}/* *  OrExp * *  役割：&lt;NonterminalExpression&gt; */public class OrExp extends BooleanExp {    public OrExp(BooleanExp op1, BooleanExp op2) {        _operand1 = op1;        _operand2 = op2;    }    public boolean evaluate(Context aContext) {        return _operand1.evaluate(aContext) ||               _operand2.evaluate(aContext);    }    public BooleanExp replace(String name, BooleanExp exp) {        return new OrExp(_operand1.replace(name, exp),                         _operand2.replace(name, exp));    }    public Object clone() {        return new OrExp((BooleanExp)_operand1.clone(),                         (BooleanExp)_operand2.clone());    }    private BooleanExp _operand1;    private BooleanExp _operand2;}/* *  NotExp * *  役割：&lt;NonterminalExpression&gt; */public class NotExp extends BooleanExp {    public NotExp(BooleanExp op) {        _operand = op;    }    public boolean evaluate(Context aContext) {        return !_operand.evaluate(aContext);    }    public BooleanExp replace(String name, BooleanExp exp) {        return new NotExp(_operand.replace(name, exp));    }    public Object clone() {        return new NotExp((BooleanExp)_operand.clone());    }    private BooleanExp _operand;}</pre><p></font></body></html>