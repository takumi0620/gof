<html><head><title>java sample code</title><meta http-equiv="Content-Type" content="text/html; charset=x-sjis"></head><body bgcolor=#ffffff text=#000000><img src="img/00/java.gif" hspace="10"><font style="margin-left:40px"><p>使用例：<p><pre>      // Graphic オブジェクトを使用する次のようなクラス TextDocument      // があるとする：      public class TextDocument {          public TextDocument() {              // ...          }          public insert(Graphic g) {              // ...          }          // ...      }      // このクラスのオブジェクトには、次のようにして ImageProxy を差      // し込むことができる：      TextDocument text = new TextDocument();      // ...      text.insert(new ImageProxy(new java.io.File("anImageFileName")));</pre><hr><pre>import java.awt.*;import java.awt.event.*;import java.io.*;/* *  Graphic * *  役割：&lt;Subject&gt; */public abstract class Graphic            implements MouseListener, MouseMotionListener {    public abstract void draw(Point at);    // MouseListener インターフェースのメソッド    public void mousePressed(MouseEvent e) {}    public void mouseReleased(MouseEvent e) {}    public void mouseClicked(MouseEvent e) {}    public void mouseEntered(MouseEvent e) {}    public void mouseExited(MouseEvent e) {}    // MouseMoutionListener インターフェースのメソッド    public void mouseDragged(MouseEvent e) {}    public void mouseMoved(MouseEvent e) {}    public abstract Dimension getExtent();    public abstract void load(ObjectInputStream from);    public abstract void save(ObjectOutputStream to);}/* *  Image * *  役割：&lt;RealSubject&gt; */public class Image extends Graphic {    public Image(File imageFile) {        // ファイルから画像を読み込む    }    public void draw(Point at) {        // ...    }    // 必要な MouseLister インターフェースのメソッドを実装    public void mousePressed(MouseEvent e) {        // ...    }    // ...    // 必要な MouseMotionListener インターフェースのメソッドを実装    public void mouseDragged(MouseEvent e) {        // ...    }    // ...    public Dimension getExtent() {        // ...    }    public void load(ObjectInputStream from) {        // ...    }    public void save(ObjectOutputStream to) {        // ...    }    // ...}/* *  ImageProxy * *  役割：&lt;Proxy&gt; */public class ImageProxy extends Graphic {    public ImageProxy(File imageFile) {        _file = imageFile;        _extent = null;        _image = null;    }    public void draw(Point at) {        getImage().draw(at);    }    // MouseLister インターフェースのメソッド    public void mousePressed(MouseEvent e) {        getImage().mousePressed(e);    }    // ...    // MouseMotionListener インターフェースのメソッド    public void mouseDragged(MouseEvent e) {        getImage().mouseDragged(e);    }    // ...    public Dimension getExtent() {        if (_extent == null) {            _extent = getImage().getExtent();        }        return _extent;    }    public void load(ObjectInputStream from) {        try {            _extent = (Dimension)from.readObject();            _file = (File)from.readObject();        } catch (Exception e) { System.exit(0); }    }    public void save(ObjectOutputStream to) {        try {            to.writeObject(_file);            to.writeObject(_extent);        } catch (Exception e) { System.exit(0); }    }    protected Image getImage() {        if (_image == null) {            _image = new Image(_file);        }        return _image;    }    private Image _image;    private Dimension _extent;    private File _file;}</pre><p></font></body></html>