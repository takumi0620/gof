<html><head><title>java sample code</title><meta http-equiv="Content-Type" content="text/html; charset=x-sjis"></head><body bgcolor=#ffffff text=#000000><img src="img/00/java.gif" hspace="10"><font style="margin-left:40px"><p><pre>/* *  MazeBuilder * *  役割：&lt;Builder&gt; */public abstract class MazeBuilder {    /*     *  &lt;Builder&gt; インターフェース     */    // &lt;Product&gt; 作成メソッド    public void buildMaze() { }    public void buildRoom(int room) { }    public void buildDoor(int roomFrom, int roomTo) { }    // &lt;Product&gt; 取り出しメソッド    public Maze getMaze() { return null; }}/* *  StandardMazeBuilder * *  役割：&lt;ConcreteBuilder&gt; * *  使用例： * *      Maze maze; *      MazeGame game = new MazeGame(); *      StandardMazeBuilder builder = new StandardMazeBuilder(); * *      game.createMaze(builder); *      maze = builder.getMaze(); */public class StandardMazeBuilder extends MazeBuilder {    /*     *  コンストラクタ     */    public StandardMazeBuilder() {        _currentMaze = null;    }    /*     *  &lt;ConcreteBuilder&gt; インターフェース     */    // &lt;Product&gt; 作成メソッド    public void buildMaze() {        _currentMaze = new Maze();    }    public void buildRoom(int n) {        if (_currentMaze.roomNo(n) != null) {            Room room = new Room(n);            _currentMaze.addRoom(room);            room.setSide(MapSite.NORTH, new Wall());            room.setSide(MapSite.SOUTH, new Wall());            room.setSide(MapSite.EAST, new Wall());            room.setSide(MapSite.WEST, new Wall());        }    }    public void buildDoor(int n1, int n2) {        Room r1 = _currentMaze.roomNo(n1);        Room r2 = _currentMaze.roomNo(n2);        Door d = new Door(r1, r2);        r1.setSide(CommonWall(r1, r2), d);        r2.setSide(CommonWall(r2, r1), d);    }    // &lt;Product&gt; 取り出しメソッド    public Maze getMaze() {        Maze maze = _currentMaze;        return maze;    }    /*     *  プライベートメンバ     */    private int CommonWall(Room r1, Room r2) {        // ...    }    Maze _currentMaze;}/* *  CountingMazeBuilder * *  役割：&lt;ConcreteBuilder&gt; * *  使用例： * *      int rooms, doors; *      MazeGame game = new MazeGame(); *      CountingMazeBuilder builder = CountingMazeBuilder(); * *      game.createMaze(builder); *      rooms = builder.getRoomCount(); *      doors = builder.getDoorCount(); * *      System.out.println("The maze has " + rooms + " rooms and " *                         + doors + "doors"); */public class CountingMazeBuilder extends MazeBuilder {    /*     *  コンストラクタ     */    public CountingMazeBuilder() {        _rooms = _doors = 0;    }    /*     *  &lt;ConcreteBuilder&gt; インターフェース     */    // &lt;Product&gt; 作成メソッド    public void buildRoom(int n) {        _rooms++;    }    public void buildDoor(int n1, int n2) {        _doors++;    }    public void addWall(int n, int direction) {        // ...    }    // &lt;Product&gt; 取り出しメソッド -- なし（&lt;Builder&gt; で定義）    // この &lt;ConcreteBuilder&gt; 独自のインターフェース    public int getRoomCount() {        return _rooms;    }    public int getDoorCount() {        return _doors;    }    /*     *  プライベートメンバ     */    int _doors;    int _rooms;}/* *  MapSite * *  役割：（Room, Wall, Door の抽象クラス） */public interface MapSite {    public static final int NORTH = 0;    public static final int SOUTH = 1;    public static final int EAST = 2;    public static final int WEST = 3;    public void enter();}/* *  Room * *  役割：&lt;ConcreteProduct&gt;&lt;AbstractProduct&gt;/AbstractFactory */public class Room implements MapSite {    public Room(int roomNo)        { _roomNumber = roomNo; }    public MapSite getSide(int aDirection) {        return _sides[aDirection];    }    public void setSide(int aDirection, MapSite aMapSite) {        _sides[aDirection] = aMapSite;    }    public void enter() {        // ...    }    private int _roomNumber;    private MapSite _sides[] = new MapSite[4];}/* *  Wall * *  役割：&lt;ConcreteProduct&gt;&lt;AbstractProduct&gt;/AbstractFactory */public class Wall implements MapSite {    public Wall() {        // ...    }    public void enter() {        // ...    }}/* *  Door * *  役割：&lt;ConcreteProduct&gt;&lt;AbstractProduct&gt;/AbstractFactory */public class Door implements MapSite {    public Door(Room r1, Room r2) {        _room1 = r1;        _room2 = r2;    }    public void enter() {        // ...    }    public Room otherSideFrom(Room  aRoom) {        // ...    }    private Room _room1 = null;    private Room _room2 = null;    private boolean _isOpen;}/* *  Maze * *  役割：&lt;ConcreteProduct&gt;&lt;AbstractProduct&gt;/AbstractFactory */public class Maze {    public Maze() {        // ...    }    public void addRoom(Room aRoom) {        // ...    }    public Room roomNo(int n) {        // ...    }}/* *  MazeGame * *  役割：&lt;Client&gt;/AbstractFactory, &lt;Director&gt;/Builder */public class MazeGame {    public Maze createMaze() {        Maze aMaze = new Maze();        Room r1 = new Room(1);        Room r2 = new Room(2);        Door theDoor = new Door(r1, r2);        aMaze.addRoom(r1);        aMaze.addRoom(r2);        r1.setSide(MapSite.NORTH, new Wall());        r1.setSide(MapSite.EAST, theDoor);        r1.setSide(MapSite.SOUTH, new Wall());        r1.setSide(MapSite.WEST, new Wall());        r2.setSide(MapSite.NORTH, new Wall());        r2.setSide(MapSite.EAST, new Wall());        r2.setSide(MapSite.SOUTH, new Wall());        r2.setSide(MapSite.WEST, theDoor);        return aMaze;    }    /*     *  &lt;Director&gt;/Builder インターフェース     */    public Maze createMaze(MazeBuilder builder) {        builder.buildMaze();        builder.buildRoom(1);        builder.buildRoom(2);        builder.buildDoor(1, 2);        return builder.getMaze();    }    public Maze CreateComplexMaze(MazeBuilder builder) {        builder.buildRoom(1);        // ...        builder.buildRoom(1001);        return builder.getMaze();    }    // ...}</pre><p></font></body></html>